
apply plugin: 'java'
apply plugin: 'groovy'
apply plugin: "maven"

defaultTasks 'build', 'uploadArchives'

ext.artifactId = "$projectName-main"

repositories {
	ivy {
		name = 'DynamicRepo'
		ivyPattern "${repoGenBase}/[organisation]/[module]/ivy-[revision].xml"
		artifactPattern "${repoGenBase}/[organisation]/[module]/[type]s/[artifact]-[revision].[ext]"
	}
	mavenCentral()
//	maven {
//		url nexusUrlGroups
//	}
}

dependencies {
	compile group: 'org.codehaus.groovy', name: 'groovy-all', version: '2.1.4'
	compile group: 'org.functionaljava', name: 'functionaljava', version: '3.1'
//	testCompile group: 'org.codehaus.groovy', name: 'groovy-test', version: '2.0.5'
	testCompile group: 'junit', name: 'junit', version: '4.10'
//	compile project(":core")
	compile group: 'functionalgroovy', name: 'core', version: '0.1-SNAPSHOT', changing: true
//	compile project(":${projectName}-core")
}

jar {
	baseName artifactId
	manifest {
		attributes 'Created-By': founder, 'Signature-Version': version
	}
}

build.dependsOn ':core:uploadArchives'
//build(dependsOn: ':core:uploadArchives') << {
//}

uploadArchives {
	repositories {
		add project.repositories.DynamicRepo
//		mavenDeployer {
//			repository(url: "http://${nexusUrl}/nexus/content/repositories/snapshots") {
//				authentication(userName: "admin", password: "admin123")
//			}
//			pom.version = version
//			pom.artifactId = artifactId
//			pom.groupId = groupId
//		}

	}
}
